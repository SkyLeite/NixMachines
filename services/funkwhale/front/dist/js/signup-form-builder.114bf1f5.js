(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["signup-form-builder"],{"25ba":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("form",{staticClass:"ui form",on:{submit:function(e){return e.preventDefault(),t.submit()}}},[t.error?a("div",{staticClass:"ui negative message",attrs:{role:"alert"}},[a("h4",{staticClass:"header"},[a("translate",{attrs:{"translate-context":"Content/Login/Error message.Title"}},[t._v(" We cannot log you in ")])],1),a("ul",{staticClass:"list"},["invalid_credentials"==t.error&&t.$store.state.instance.settings.moderation.signup_approval_enabled.value?a("li",[a("translate",{attrs:{"translate-context":"Content/Login/Error message.List item/Call to action"}},[t._v(" If you signed-up recently, you may need to wait before our moderation team review your account, or verify your e-mail address. ")])],1):"invalid_credentials"==t.error?a("li",[a("translate",{attrs:{"translate-context":"Content/Login/Error message.List item/Call to action"}},[t._v(" Please double-check that your username and password combination is correct and make sure you verified your e-mail address. ")])],1):a("li",[t._v(" "+t._s(t.error)+" ")])])]):t._e(),t.$store.getters["instance/appDomain"]===t.$store.getters["instance/domain"]?[a("div",{staticClass:"field"},[a("label",{attrs:{for:"username-field"}},[a("translate",{attrs:{"translate-context":"Content/Login/Input.Label/Noun"}},[t._v("Username or e-mail address")]),t.showSignup?[t._v(" | "),a("router-link",{attrs:{to:{path:"/signup"}}},[a("translate",{attrs:{"translate-context":"*/Signup/Link/Verb"}},[t._v("Create an account")])],1)]:t._e()],2),a("input",{directives:[{name:"model",rawName:"v-model",value:t.credentials.username,expression:"credentials.username"}],ref:"username",attrs:{id:"username-field",required:"",name:"username",type:"text",autofocus:"",placeholder:t.labels.usernamePlaceholder},domProps:{value:t.credentials.username},on:{input:function(e){e.target.composing||t.$set(t.credentials,"username",e.target.value)}}})]),a("div",{staticClass:"field"},[a("label",{attrs:{for:"password-field"}},[a("translate",{attrs:{"translate-context":"*/*/*"}},[t._v("Password")]),t._v(" | "),a("router-link",{attrs:{tabindex:"1",to:{name:"auth.password-reset",query:{email:t.credentials.username}}}},[a("translate",{attrs:{"translate-context":"*/Login/*/Verb"}},[t._v("Reset your password")])],1)],1),a("password-input",{attrs:{"field-id":"password-field",required:""},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}})],1)]:[a("p",[a("translate",{attrs:{"translate-context":"Contant/Auth/Paragraph","translate-params":{domain:t.$store.getters["instance/domain"]}}},[t._v(" You will be redirected to %{ domain } to authenticate. ")])],1)],a("button",{class:["ui",{loading:t.isLoading},"right","floated",t.buttonClasses,"button"],attrs:{type:"submit"}},[a("translate",{attrs:{"translate-context":"*/Login/*/Verb"}},[t._v(" Login ")])],1)],2)},s=[],r=a("c7eb"),i=a("1da1"),o=a("663d"),l={components:{PasswordInput:o["a"]},props:{next:{type:String,default:"/library"},buttonClasses:{type:String,default:"success"},showSignup:{type:Boolean,default:!0}},data:function(){return{credentials:{username:"",password:""},error:"",isLoading:!1}},computed:{labels:function(){var t=this.$pgettext("Content/Login/Input.Placeholder","Enter your username or e-mail address");return{usernamePlaceholder:t}}},created:function(){this.$store.state.auth.authenticated&&this.$router.push(this.next)},mounted:function(){this.$refs.username&&this.$refs.username.focus()},methods:{submit:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.getters["instance/appDomain"]!==t.$store.getters["instance/domain"]){e.next=6;break}return e.next=3,t.submitSession();case 3:return e.abrupt("return",e.sent);case 6:return t.isLoading=!0,e.next=9,t.$store.dispatch("auth/oauthLogin",t.next);case 9:case"end":return e.stop()}}),e)})))()},submitSession:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var a,n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=t,a.isLoading=!0,t.error="",n={username:t.credentials.username,password:t.credentials.password},t.$store.dispatch("auth/login",{credentials:n,next:t.next,onError:function(t){400===t.response.status?a.error="invalid_credentials":a.error=t.backendErrors[0]}}).then((function(t){a.isLoading=!1}));case 5:case"end":return e.stop()}}),e)})))()}}},u=l,d=a("2877"),c=Object(d["a"])(u,n,s,!1,null,null,null);e["a"]=c.exports},"56f3":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"ui top attached tabular menu"},[a("button",{class:[{active:!t.isPreviewing},"item"],on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.isPreviewing=!1}}},[a("translate",{attrs:{"translate-context":"Content/*/Button.Label/Verb"}},[t._v(" Edit form ")])],1),a("button",{class:[{active:t.isPreviewing},"item"],on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.isPreviewing=!0}}},[a("translate",{attrs:{"translate-context":"*/Form/Menu.item"}},[t._v(" Preview form ")])],1)]),t.isPreviewing?a("div",{staticClass:"ui bottom attached segment"},[a("signup-form",{attrs:{customization:t.local,"signup-approval-enabled":t.signupApprovalEnabled,"fetch-description-html":!0}}),a("div",{staticClass:"ui clearing hidden divider"})],1):a("div",{staticClass:"ui bottom attached segment"},[a("div",{staticClass:"field"},[a("label",{attrs:{for:"help-text"}},[a("translate",{attrs:{"translate-context":"*/*/Label"}},[t._v("Help text")])],1),a("p",[a("translate",{attrs:{"translate-context":"*/*/Help"}},[t._v(" An optional text to be displayed at the start of the sign-up form. ")])],1),a("content-form",{attrs:{"field-id":"help-text",permissive:!0,value:(t.local.help_text||{}).text},on:{input:function(e){return t.update("help_text.text",e)}}})],1),a("div",{staticClass:"field"},[a("label",[a("translate",{attrs:{"translate-context":"*/*/Label"}},[t._v("Additional fields")])],1),a("p",[a("translate",{attrs:{"translate-context":"*/*/Help"}},[t._v(" Additional form fields to be displayed in the form. Only shown if manual sign-up validation is enabled. ")])],1),t.local.fields.length>0?a("table",[a("thead",[a("tr",[a("th",[a("translate",{attrs:{"translate-context":"*/*/Form-builder,Help"}},[t._v(" Field label ")])],1),a("th",[a("translate",{attrs:{"translate-context":"*/*/Form-builder,Help"}},[t._v(" Field type ")])],1),a("th",[a("translate",{attrs:{"translate-context":"*/*/Form-builder,Help"}},[t._v(" Required ")])],1),a("th",[a("span",{staticClass:"visually-hidden"},[a("translate",{attrs:{"translate-context":"*/*/Form-builder,Help"}},[t._v("Actions")])],1)])])]),a("tbody",t._l(t.local.fields,(function(e,n){return a("tr",{key:n},[a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.label,expression:"field.label"}],attrs:{type:"text",required:""},domProps:{value:e.label},on:{input:function(a){a.target.composing||t.$set(e,"label",a.target.value)}}})]),a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.input_type,expression:"field.input_type"}],on:{change:function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"input_type",a.target.multiple?n:n[0])}}},[a("option",{attrs:{value:"short_text"}},[a("translate",{attrs:{"translate-context":"*/*/Form-builder"}},[t._v(" Short text ")])],1),a("option",{attrs:{value:"long_text"}},[a("translate",{attrs:{"translate-context":"*/*/Form-builder"}},[t._v(" Long text ")])],1)])]),a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.required,expression:"field.required"}],on:{change:function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"required",a.target.multiple?n:n[0])}}},[a("option",{domProps:{value:!0}},[a("translate",{attrs:{"translate-context":"*/*/*"}},[t._v(" Yes ")])],1),a("option",{domProps:{value:!1}},[a("translate",{attrs:{"translate-context":"*/*/*"}},[t._v(" No ")])],1)])]),a("td",[a("i",{class:["up","arrow",{disabled:0===n},"icon"],attrs:{disabled:0===n,role:"button",title:t.labels.up},on:{click:function(e){return t.move(n,-1)}}}),a("i",{class:["down","arrow",{disabled:n>=t.local.fields.length-1},"icon"],attrs:{disabled:n>=t.local.fields.length-1,role:"button",title:t.labels.down},on:{click:function(e){return t.move(n,1)}}}),a("i",{staticClass:"x icon",attrs:{role:"button",title:t.labels.delete},on:{click:function(e){return t.remove(n)}}})])])})),0)]):t._e(),a("div",{staticClass:"ui hidden divider"}),t.local.fields.length<t.maxFields?a("button",{staticClass:"ui basic button",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addField.apply(null,arguments)}}},[a("translate",{attrs:{"translate-context":"*/*/Form-builder"}},[t._v(" Add a new field ")])],1):t._e()])]),a("div",{staticClass:"ui hidden divider"})])},s=[],r=(a("a434"),a("ceb5")),i=a("6589");function o(t,e,a){if(a>=t.length){var n=a-t.length+1;while(n--)t.push(void 0)}return t.splice(a,0,t.splice(e,1)[0]),t}var l={components:{SignupForm:i["a"]},props:{value:{type:Object,required:!0},signupApprovalEnabled:{type:Boolean}},data:function(){return{maxFields:10,isPreviewing:!1}},computed:{labels:function(){return{delete:this.$pgettext("*/*/*","Delete"),up:this.$pgettext("*/*/*","Move up"),down:this.$pgettext("*/*/*","Move down")}},local:function(){return this.value&&this.value.fields?this.value:{help_text:{text:null,content_type:"text/markdown"},fields:[]}}},created:function(){this.$emit("input",this.local)},methods:{addField:function(){var t=this,e=r["a"].tap(r["a"].cloneDeep(this.local),(function(e){return e.fields.push({label:t.$pgettext("*/*/Form-builder","Additional field")+" "+(t.local.fields.length+1),required:!0,input_type:"short_text"})}));this.$emit("input",e)},remove:function(t){this.$emit("input",r["a"].tap(r["a"].cloneDeep(this.local),(function(e){return e.fields.splice(t,1)})))},move:function(t,e){if(!(0===t&&e<0)&&!(t+e>=this.local.fields.length)){var a=o(r["a"].cloneDeep(this.local).fields,t,t+e);this.update("fields",a)}},update:function(t,e){"help_text.text"===t&&(t="help_text",e=e&&0!==e.length?{text:e,content_type:"text/markdown"}:null),this.$emit("input",r["a"].tap(r["a"].cloneDeep(this.local),(function(a){return r["a"].set(a,t,e)})))}}},u=l,d=a("2877"),c=Object(d["a"])(u,n,s,!1,null,null,null);e["default"]=c.exports},6589:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.submitted?a("div",[a("div",{staticClass:"ui success message"},[t.signupRequiresApproval?a("p",[a("translate",{attrs:{"translate-context":"Content/Signup/Form/Paragraph"}},[t._v(" Your account request was successfully submitted. You will be notified by e-mail when our moderation team has reviewed your request. ")])],1):a("p",[a("translate",{attrs:{"translate-context":"Content/Signup/Form/Paragraph"}},[t._v(" Your account was successfully created. Please verify your e-mail address before trying to login. ")])],1)]),a("h2",[a("translate",{attrs:{"translate-context":"Content/Login/Title/Verb"}},[t._v(" Log in to your Funkwhale account ")])],1),a("login-form",{attrs:{"button-classes":"basic success","show-signup":!1}})],1):a("form",{class:["ui",{loading:t.isLoadingInstanceSetting},"form"],on:{submit:function(e){return e.preventDefault(),t.submit()}}},[t.$store.state.instance.settings.users.registration_enabled.value?t.signupRequiresApproval?a("p",{staticClass:"ui message"},[a("translate",{attrs:{"translate-context":"Content/Signup/Form/Paragraph"}},[t._v(" Registrations on this pod are open, but reviewed by moderators before approval. ")])],1):t._e():a("p",{staticClass:"ui message"},[a("translate",{attrs:{"translate-context":"Content/Signup/Form/Paragraph"}},[t._v(" Public registrations are not possible on this instance. You will need an invitation code to sign up. ")])],1),t.formCustomization&&t.formCustomization.help_text?[a("rendered-description",{attrs:{content:t.formCustomization.help_text,"fetch-html":t.fetchDescriptionHtml,permissive:!0}}),a("div",{staticClass:"ui hidden divider"})]:t._e(),t.errors.length>0?a("div",{staticClass:"ui negative message",attrs:{role:"alert"}},[a("h4",{staticClass:"header"},[a("translate",{attrs:{"translate-context":"Content/Signup/Form/Paragraph"}},[t._v(" Your account cannot be created. ")])],1),a("ul",{staticClass:"list"},t._l(t.errors,(function(e,n){return a("li",{key:n},[t._v(" "+t._s(e)+" ")])})),0)]):t._e(),a("div",{staticClass:"required field"},[a("label",{attrs:{for:"username-field"}},[a("translate",{attrs:{"translate-context":"Content/*/*"}},[t._v("Username")])],1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],ref:"username",attrs:{id:"username-field",name:"username",required:"",type:"text",autofocus:"",placeholder:t.labels.usernamePlaceholder},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),a("div",{staticClass:"required field"},[a("label",{attrs:{for:"email-field"}},[a("translate",{attrs:{"translate-context":"Content/*/*/Noun"}},[t._v("E-mail address")])],1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],ref:"email",attrs:{id:"email-field",name:"email",required:"",type:"email",placeholder:t.labels.emailPlaceholder},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),a("div",{staticClass:"required field"},[a("label",{attrs:{for:"password-field"}},[a("translate",{attrs:{"translate-context":"*/*/*"}},[t._v("Password")])],1),a("password-input",{attrs:{"field-id":"password-field"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),t.$store.state.instance.settings.users.registration_enabled.value?t._e():a("div",{staticClass:"required field"},[a("label",{attrs:{for:"invitation-code"}},[a("translate",{attrs:{"translate-context":"Content/*/Input.Label"}},[t._v("Invitation code")])],1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.invitation,expression:"invitation"}],attrs:{id:"invitation-code",required:"",type:"text",name:"invitation",placeholder:t.labels.placeholder},domProps:{value:t.invitation},on:{input:function(e){e.target.composing||(t.invitation=e.target.value)}}})]),t.signupRequiresApproval&&t.formCustomization&&t.formCustomization.fields&&t.formCustomization.fields.length>0?t._l(t.formCustomization.fields,(function(e,n){return a("div",{key:n,class:[{required:e.required},"field"]},[a("label",{attrs:{for:"custom-field-"+n}},[t._v(t._s(e.label))]),"long_text"===e.input_type?a("textarea",{attrs:{id:"custom-field-"+n,required:e.required,rows:"5"},domProps:{value:t.customFields[e.label]},on:{input:function(a){return t.$set(t.customFields,e.label,a.target.value)}}}):a("input",{attrs:{id:"custom-field-"+n,type:"text",required:e.required},domProps:{value:t.customFields[e.label]},on:{input:function(a){return t.$set(t.customFields,e.label,a.target.value)}}})])})):t._e(),a("button",{class:["ui",t.buttonClasses,{loading:t.isLoading}," right floated button"],attrs:{type:"submit"}},[a("translate",{attrs:{"translate-context":"Content/Signup/Button.Label"}},[t._v(" Create my account ")])],1)],2)},s=[],r=a("bc3a"),i=a.n(r),o=a("3677"),l=a("25ba"),u=a("663d"),d={components:{LoginForm:l["a"],PasswordInput:u["a"]},props:{defaultInvitation:{type:String,required:!1,default:null},next:{type:String,default:"/"},buttonClasses:{type:String,default:"success"},customization:{type:Object,default:null},fetchDescriptionHtml:{type:Boolean,default:!1},signupApprovalEnabled:{type:Boolean,default:null,required:!1}},data:function(){return{username:"",email:"",password:"",isLoadingInstanceSetting:!0,errors:[],isLoading:!1,invitation:this.defaultInvitation,customFields:{},submitted:!1}},computed:{labels:function(){var t=this.$pgettext("Content/Signup/Form/Placeholder","Enter your invitation code (case insensitive)"),e=this.$pgettext("Content/Signup/Form/Placeholder","Enter your username"),a=this.$pgettext("Content/Signup/Form/Placeholder","Enter your e-mail address");return{usernamePlaceholder:e,emailPlaceholder:a,placeholder:t}},formCustomization:function(){return this.customization||this.$store.state.instance.settings.moderation.signup_form_customization.value},signupRequiresApproval:function(){return null===this.signupApprovalEnabled?this.$store.state.instance.settings.moderation.signup_approval_enabled.value:this.signupApprovalEnabled}},created:function(){var t=this;this.$store.dispatch("instance/fetchSettings",{callback:function(){t.isLoadingInstanceSetting=!1}})},methods:{submit:function(){var t=this;t.isLoading=!0,this.errors=[];var e={username:this.username,password1:this.password,password2:this.password,email:this.email,invitation:this.invitation,request_fields:this.customFields};return i.a.post("auth/registration/",e).then((function(e){o["a"].default.info("Successfully created account"),t.submitted=!0,t.isLoading=!1}),(function(e){t.errors=e.backendErrors,t.isLoading=!1}))}}},c=d,p=a("2877"),m=Object(p["a"])(c,n,s,!1,null,null,null);e["a"]=m.exports},"663d":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ui fluid action input"},[a("input",{attrs:{id:t.fieldId,required:"",name:"password",type:t.passwordInputType},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}}),a("button",{staticClass:"ui icon button",attrs:{type:"button",title:t.labels.title},on:{click:function(e){e.preventDefault(),t.showPassword=!t.showPassword}}},[a("i",{staticClass:"eye icon"})]),t.copyButton?a("button",{staticClass:"ui icon button",attrs:{type:"button",title:t.labels.copy},on:{click:function(e){return e.preventDefault(),t.copyPassword.apply(null,arguments)}}},[a("i",{staticClass:"copy icon"})]):t._e()])},s=[],r={props:{value:{type:String,required:!0},defaultShow:{type:Boolean,default:!1},copyButton:{type:Boolean,default:!1},fieldId:{type:String,required:!0}},data:function(){return{showPassword:this.defaultShow||!1}},computed:{labels:function(){return{title:this.$pgettext("Content/Settings/Button.Tooltip/Verb","Show/hide password"),copy:this.$pgettext("*/*/Button.Label/Short, Verb","Copy")}},passwordInputType:function(){return this.showPassword?"text":"password"}},methods:{copyPassword:function(){try{this._copyStringToClipboard(this.value),this.$store.commit("ui/addMessage",{content:this.$pgettext("Content/*/Paragraph","Text copied to clipboard!"),date:new Date})}catch(t){console.error("Cannot copy",t)}},_copyStringToClipboard:function(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style={position:"absolute",left:"-9999px"},document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}}},i=r,o=a("2877"),l=Object(o["a"])(i,n,s,!1,null,null,null);e["a"]=l.exports}}]);